<!-- index.wxml - æ¸¸æˆä¸»é¡µé¢ç»“æ„ -->
<view class="container {{theme === 'dark' ? 'dark-theme' : 'light-theme'}}">
  <view class="title">ç‚¹æˆ‘+1</view>
  
  <!-- é¡¶éƒ¨åŒºåŸŸï¼šæ ‡é¢˜å’Œå†å²è®°å½• -->
  <view class="top-container">
    <view class="records-display">
      <view>æœ€é«˜æ•°å­—: {{recordHighestNumber}}</view>
      <view>æœ€é«˜ç§¯åˆ†: {{recordHighestScore}}</view>
    </view>
    <!-- <view class="theme-switch">
      <view class="switch" bindtap="toggleTheme">
        <view class="slider {{theme === 'dark' ? 'checked' : ''}}"></view>
      </view>
      <text class="theme-label">æš—é»‘æ¨¡å¼</text>
    </view> -->
  </view>
  
  
  <view class="game-info-row">
    <view class="score-display">ğŸ† {{score}}</view>
    <view class="counter-label">ğŸ’¡ å‰©ä½™: {{clicksLeft}}</view>
  </view>
  
  <!-- æ¸¸æˆæ£‹ç›˜ -->
  <view class="game-board">
    <block wx:for="{{board}}" wx:for-item="row" wx:for-index="rowIndex" wx:key="rowIndex">
      <block wx:for="{{row}}" wx:for-item="cell" wx:for-index="colIndex" wx:key="colIndex">
        <view 
          class="cell {{cell === null ? 'empty' : ''}} {{cellHighlight[rowIndex]&&cellHighlight[rowIndex][colIndex] ? 'highlight' : ''}} {{newConnected[rowIndex+'-'+colIndex] ? 'new-connected' : ''}}"
          data-row="{{rowIndex}}" 
          data-col="{{colIndex}}" 
          data-value="{{cell}}"
          style="{{cell !== null ? getCellStyle(cell) : ''}}"
          catchtap="handleCellTap"
        >
          {{cell !== null ? cell : ''}}
        </view>
      </block>
    </block>
    
    <!-- å¾—åˆ†å¼¹å‡ºåŠ¨ç”» -->
    <view wx:if="{{scorePopup.visible}}" class="score-popup {{scorePopup.fadeOut ? 'fade-up' : ''}}" 
      style="left: {{50 + scorePopup.col * 62}}px; top: {{50 + scorePopup.row * 62}}px;">
      +{{scorePopup.score}}
    </view>
  </view>
  
  <!-- é‡æ–°å¼€å§‹æŒ‰é’® -->
  <button class="restart-btn" bindtap="restartGame">é‡æ–°å¼€å§‹</button>
  
  <!-- æ¸¸æˆç»“æŸæ¨¡æ€æ¡† -->
  <view class="modal-mask" wx:if="{{modalVisible}}" catchtouchmove="preventTouchMove">
    <view class="modal-content">
      <view class="modal-header">{{modalTitle}}</view>
      
      <!-- æ¸¸æˆç»“æŸç»Ÿè®¡ -->
      <block wx:if="{{modalType === 'gameEnd'}}">
        <view class="game-results">
          <view>æœ¬å±€å¾—åˆ†: <text class="highlight-text">{{gameEndStats.score}}</text></view>
          <view>æœ€å¤§æ•°å­—: <text class="highlight-text">{{gameEndStats.maxNumber}}</text></view>
        </view>
        
        <!-- å¦‚æœç ´çºªå½•ï¼Œæ˜¾ç¤ºæ­å–œä¿¡æ¯ -->
        <block wx:if="{{gameEndStats.isNewNumberRecord || gameEndStats.isNewScoreRecord}}">
          <view class="congrats">æ­å–œä½ æ‰“ç ´è®°å½•ï¼</view>
          <view wx:if="{{gameEndStats.isNewNumberRecord}}">
            æ–°çš„æœ€é«˜æ•°å­—: <text class="record-text">{{gameEndStats.maxNumber}}</text>
          </view>
          <view wx:if="{{gameEndStats.isNewScoreRecord}}">
            æ–°çš„æœ€é«˜åˆ†æ•°: <text class="record-text">{{gameEndStats.score}}</text>
          </view>
        </block>
      </block>
      
      <!-- ç¡®è®¤å¯¹è¯æ¡†å†…å®¹ -->
      <view wx:if="{{modalType === 'confirm'}}" class="modal-message">
        {{modalMessage}}
      </view>
      
      <!-- æ¨¡æ€æ¡†æŒ‰é’® -->
      <view class="modal-footer">
        <view wx:if="{{modalType === 'confirm'}}" class="modal-btn" bindtap="closeModal">å–æ¶ˆ</view>
        <view class="modal-btn primary-btn" bindtap="confirmModal">
          {{modalType === 'gameEnd' ? 'é‡æ–°å¼€å§‹' : 'ç¡®å®š'}}
        </view>
      </view>
    </view>
  </view>
</view> 